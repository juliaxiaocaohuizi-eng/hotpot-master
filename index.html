<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hot Pot Master: Progressive Memory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=ZCOOL+XiaoWei&display=swap');

        :root {
            --pot-gold: #d4af37;
            --spicy-red: #b30000;
            --clear-gold: #fdf5e6;
            --tomato-orange: #ff6347;
            --steam-white: rgba(255, 255, 255, 0.4);
        }

        body {
            background-color: #1a0f0f;
            color: #ecf0f1;
            font-family: 'ZCOOL+XiaoWei', 'Segoe UI', serif;
            overflow: hidden;
            touch-action: none;
        }

        .hotpot-container {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 10px auto;
        }

        .pot-outer {
            width: 100%;
            height: 100%;
            background: #222;
            border: 12px solid #8b0000;
            border-radius: 50%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8), inset 0 0 20px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
            z-index: 10;
        }

        /* Broth Sections */
        .broth-section {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            transition: clip-path 0.5s ease;
        }

        /* Standard 2-way split */
        .spicy-side {
            background: radial-gradient(circle at 30% 30%, #ff4500, #800000);
            clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%);
        }

        .clear-side {
            background: radial-gradient(circle at 70% 30%, #fff9e6, #e6cc80);
            clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);
        }

        /* Triple Pot (Level 5+) Mercedes Split: 0deg, 120deg, 240deg */
        /* Note: Using 50% 50% as the meeting point */
        .pot-outer.triple .spicy-side {
            /* Top Left: Between 240deg and 0deg (360deg) */
            clip-path: polygon(50% 50%, 50% 0, 0 0, 0 100%, 6.7% 75%);
        }
        .pot-outer.triple .clear-side {
            /* Top Right: Between 0deg and 120deg */
            clip-path: polygon(50% 50%, 50% 0, 100% 0, 100% 100%, 93.3% 75%);
        }
        .tomato-side {
            background: radial-gradient(circle at 50% 80%, #ff7f50, #cc4400);
            display: none;
        }
        .pot-outer.triple .tomato-side {
            display: block;
            /* Bottom Center: Between 120deg and 240deg */
            clip-path: polygon(50% 50%, 93.3% 75%, 100% 100%, 0 100%, 6.7% 75%);
        }

        /* Divider Lines */
        .pot-divider {
            position: absolute;
            left: 50%;
            top: 50%;
            height: 160px;
            width: 8px;
            background: #8b0000;
            transform-origin: top center;
            z-index: 15;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        .ingredient {
            position: absolute;
            cursor: pointer;
            transition: transform 0.1s;
            user-select: none;
            z-index: 50; 
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: auto;
        }

        .ingredient-icon {
            font-size: 2.5rem;
            filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.3));
            pointer-events: none;
        }

        .cooking-timer {
            font-size: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            margin-top: -5px;
            border: 1px solid rgba(255,255,255,0.2);
            pointer-events: none;
        }

        .steam {
            position: absolute;
            background: var(--steam-white);
            border-radius: 50%;
            filter: blur(12px);
            pointer-events: none;
            animation: rise 2.5s infinite linear;
            z-index: 30;
        }

        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(20, 10, 10, 0.95);
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
        }

        #memory-phase { display: none; }
        #game-over { display: none; }

        .recipe-card {
            background: #2d1b1b;
            border: 2px solid #d4af37;
            border-radius: 1rem;
            padding: 1rem;
            width: 100%;
            max-width: 320px;
        }

        .ingredient-source {
            touch-action: none;
            cursor: grab;
            user-select: none;
            transition: transform 0.2s;
        }
        .ingredient-source:active { cursor: grabbing; transform: scale(1.1); }

        .drag-proxy {
            position: fixed;
            pointer-events: none;
            font-size: 2.5rem;
            z-index: 1000;
            display: none;
        }

        .garnish { position: absolute; opacity: 0.5; pointer-events: none; }
        .chili-flake { width: 8px; height: 12px; background: #600; border-radius: 50% 20% 50% 20%; }
        .scallion { width: 10px; height: 10px; border: 2px solid #2d5a27; background: #4a8c42; border-radius: 50%; }
        .tomato-piece { width: 15px; height: 15px; background: #ff4d4d; border: 1px solid #900; border-radius: 40% 60% 30% 70%; }

        @keyframes rise {
            0% { transform: translateY(0) scale(1); opacity: 0; }
            100% { transform: translateY(-120px) scale(2); opacity: 0; }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-start min-h-screen p-4 overflow-hidden">

    <!-- HUD -->
    <div class="text-center mt-2 mb-2">
        <h1 class="text-3xl font-bold text-yellow-500 tracking-widest" style="text-shadow: 2px 2px #000;">MEMORY POT</h1>
        <p id="phase-label" class="text-xs text-red-400 font-bold uppercase tracking-widest">Wait for Recipe...</p>
    </div>

    <div class="flex gap-4 mb-4 bg-black/40 px-6 py-1 rounded-full border border-yellow-900/50">
        <div class="text-center">
            <span class="block text-[10px] uppercase text-yellow-600">Level</span>
            <span id="level" class="text-xl font-bold text-white">1</span>
        </div>
        <div class="text-center px-4 border-l border-r border-yellow-900/30">
            <span class="block text-[10px] uppercase text-yellow-600">Time</span>
            <span id="level-timer" class="text-xl font-bold text-red-400">00</span>
        </div>
        <div class="text-center">
            <span class="block text-[10px] uppercase text-yellow-600">Lives</span>
            <div id="lives" class="text-lg">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        </div>
    </div>

    <!-- Main Game Area -->
    <div class="hotpot-container" id="pot-area">
        <div id="main-pot" class="pot-outer">
            <!-- Sections -->
            <div class="broth-section spicy-side">
                <div class="garnish chili-flake" style="top:25%; left:25%"></div>
                <div class="garnish chili-flake" style="top:45%; left:30%"></div>
            </div>
            <div class="broth-section clear-side">
                <div class="garnish scallion" style="top:25%; right:25%"></div>
                <div class="garnish scallion" style="top:45%; right:30%"></div>
            </div>
            <div class="broth-section tomato-side">
                <div class="garnish tomato-piece" style="bottom:15%; left:45%"></div>
                <div class="garnish tomato-piece" style="bottom:25%; left:50%"></div>
            </div>

            <!-- Triple Dividers (120 degree offsets) -->
            <div id="div-0" class="pot-divider" style="transform: translateX(-50%) rotate(0deg); display:none;"></div>
            <div id="div-120" class="pot-divider" style="transform: translateX(-50%) rotate(120deg); display:none;"></div>
            <div id="div-240" class="pot-divider" style="transform: translateX(-50%) rotate(240deg); display:none;"></div>
            
            <!-- Standard center line for 2-way -->
            <div id="divider-center" class="pot-divider" style="transform: translateX(-50%) rotate(0deg); height: 320px; top: 0;"></div>
        </div>
    </div>

    <!-- Memory Phase Overlay -->
    <div id="memory-phase" class="overlay">
        <h2 class="text-xl text-yellow-500 mb-1 font-bold tracking-widest">ROUND <span id="round-num">1</span></h2>
        <h3 class="text-2xl text-white mb-4 font-bold">MEMORIZE THE SIDES</h3>
        <div class="recipe-card mb-6">
            <div id="recipe-grid" class="grid grid-cols-2 gap-4">
                <div class="text-left border-r border-yellow-900/50 pr-2">
                    <p class="text-red-500 font-bold text-[10px] uppercase mb-1">üî• Spicy</p>
                    <div id="spicy-recipe-list" class="flex flex-wrap gap-1 text-2xl"></div>
                </div>
                <div class="text-left pl-2">
                    <p class="text-blue-300 font-bold text-[10px] uppercase mb-1">üç≤ Clear</p>
                    <div id="clear-recipe-list" class="flex flex-wrap gap-1 text-2xl"></div>
                </div>
                <div id="tomato-recipe-box" class="text-left col-span-2 mt-2 pt-2 border-t border-yellow-900/50 hidden">
                    <p class="text-orange-400 font-bold text-[10px] uppercase mb-1 text-center">üçÖ Tomato</p>
                    <div id="tomato-recipe-list" class="flex flex-wrap justify-center gap-2 text-3xl"></div>
                </div>
            </div>
        </div>
        <div class="w-full bg-gray-800 h-2 rounded-full overflow-hidden max-w-[200px]">
            <div id="memory-timer-bar" class="bg-yellow-500 h-full w-full"></div>
        </div>
        <p class="text-[10px] text-gray-500 mt-2 uppercase tracking-widest" id="timer-text">Vanish in 5s</p>
    </div>

    <!-- Palette -->
    <div class="mt-auto mb-6 grid grid-cols-4 gap-3 w-full max-w-md opacity-20 pointer-events-none transition-opacity duration-300" id="ingredient-palette">
        <div data-type="beef" class="ingredient-source bg-red-900/60 p-3 rounded-xl flex flex-col items-center shadow-lg border border-red-700/30">
            <span class="text-2xl">ü•©</span> <span class="text-[10px] mt-1 uppercase">Beef</span>
        </div>
        <div data-type="shrimp" class="ingredient-source bg-orange-900/60 p-3 rounded-xl flex flex-col items-center shadow-lg border border-orange-700/30">
            <span class="text-2xl">üç§</span> <span class="text-[10px] mt-1 uppercase">Shrimp</span>
        </div>
        <div data-type="bokchoy" class="ingredient-source bg-green-900/60 p-3 rounded-xl flex flex-col items-center shadow-lg border border-green-700/30">
            <span class="text-2xl">ü•¨</span> <span class="text-[10px] mt-1 uppercase">Veggie</span>
        </div>
        <div data-type="mushroom" class="ingredient-source bg-stone-800/60 p-3 rounded-xl flex flex-col items-center shadow-lg border border-stone-700/30">
            <span class="text-2xl">üçÑ</span> <span class="text-[10px] mt-1 uppercase">Shroom</span>
        </div>
    </div>

    <div id="drag-proxy" class="drag-proxy"></div>

    <div id="game-over" class="overlay">
        <h2 class="text-4xl text-yellow-500 mb-2 font-bold">FEAST ENDED</h2>
        <p class="text-red-200 mb-2" id="over-msg">You forgot the secret recipe...</p>
        <p class="text-sm text-gray-400 uppercase tracking-widest">Level Reached</p>
        <p class="text-3xl font-bold text-white mb-4" id="final-level">1</p>
        <p class="text-sm text-gray-400 uppercase tracking-widest">Total Score</p>
        <p class="text-5xl font-bold text-white mb-8" id="final-score">0</p>
        <button id="restart-btn" class="bg-yellow-600 hover:bg-yellow-500 text-white px-10 py-3 rounded-full font-bold shadow-xl transition-all active:scale-95">
            TRY AGAIN
        </button>
    </div>

    <div id="feedback" class="fixed top-1/2 text-2xl font-bold pointer-events-none transition-all duration-500 opacity-0 z-50"></div>

    <script>
        const potArea = document.getElementById('pot-area');
        const mainPot = document.getElementById('main-pot');
        const levelEl = document.getElementById('level');
        const timerEl = document.getElementById('level-timer');
        const livesEl = document.getElementById('lives');
        const feedbackEl = document.getElementById('feedback');
        const dragProxy = document.getElementById('drag-proxy');
        const palette = document.getElementById('ingredient-palette');
        const memoryOverlay = document.getElementById('memory-phase');
        const phaseLabel = document.getElementById('phase-label');
        const gameOverOverlay = document.getElementById('game-over');
        
        let score = 0;
        let lives = 3;
        let level = 1;
        let activeIngredients = [];
        let gameActive = false;
        let currentRecipe = { spicy: [], clear: [], tomato: [] };
        let ingredientsToCookThisRound = 0;
        let timeLeft = 0;
        let levelTimerInterval = null;

        const TYPES = {
            beef: { emoji: 'ü•©', time: 5000, points: 100 },
            shrimp: { emoji: 'üç§', time: 7000, points: 150 },
            bokchoy: { emoji: 'ü•¨', time: 4000, points: 50 },
            mushroom: { emoji: 'üçÑ', time: 9000, points: 200 }
        };

        function updatePotLayout() {
            const divCenter = document.getElementById('divider-center');
            const d0 = document.getElementById('div-0');
            const d120 = document.getElementById('div-120');
            const d240 = document.getElementById('div-240');
            const tomatoBox = document.getElementById('tomato-recipe-box');

            if (level >= 5) {
                mainPot.classList.add('triple');
                divCenter.style.display = 'none';
                d0.style.display = 'block';
                d120.style.display = 'block';
                d240.style.display = 'block';
                tomatoBox.classList.remove('hidden');
            } else {
                mainPot.classList.remove('triple');
                divCenter.style.display = 'block';
                d0.style.display = 'none';
                d120.style.display = 'none';
                d240.style.display = 'none';
                tomatoBox.classList.add('hidden');
            }
        }

        function resetGame() {
            score = 0;
            lives = 3;
            level = 1;
            clearInterval(levelTimerInterval);
            activeIngredients.forEach(ing => {
                if(ing.el && ing.el.parentNode) ing.el.parentNode.removeChild(ing.el);
            });
            activeIngredients = [];
            levelEl.innerText = level;
            livesEl.innerText = '‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è';
            gameOverOverlay.style.display = 'none';
            updatePotLayout();
            startRound();
        }

        document.getElementById('restart-btn').onclick = resetGame;

        function startRound() {
            gameActive = false;
            updatePotLayout();
            palette.style.opacity = '0.2';
            palette.style.pointerEvents = 'none';
            phaseLabel.innerText = "Memorize Now!";
            document.getElementById('round-num').innerText = level;
            levelEl.innerText = level;
            clearInterval(levelTimerInterval);
            timerEl.innerText = "00";
            
            const keys = Object.keys(TYPES);
            currentRecipe.spicy = [];
            currentRecipe.clear = [];
            currentRecipe.tomato = [];
            
            const count = Math.min(6, Math.ceil(level / 1.5) + 1);
            ingredientsToCookThisRound = count;
            
            for (let i = 0; i < count; i++) {
                const randomKey = keys[Math.floor(Math.random() * keys.length)];
                const options = level >= 5 ? ['spicy', 'clear', 'tomato'] : ['spicy', 'clear'];
                const side = options[Math.floor(Math.random() * options.length)];
                currentRecipe[side].push(randomKey);
            }

            document.getElementById('spicy-recipe-list').innerHTML = currentRecipe.spicy.map(k => `<div>${TYPES[k].emoji}</div>`).join('') || '<div class="text-[10px] text-gray-600 italic">None</div>';
            document.getElementById('clear-recipe-list').innerHTML = currentRecipe.clear.map(k => `<div>${TYPES[k].emoji}</div>`).join('') || '<div class="text-[10px] text-gray-600 italic">None</div>';
            document.getElementById('tomato-recipe-list').innerHTML = currentRecipe.tomato.map(k => `<div>${TYPES[k].emoji}</div>`).join('') || '<div class="text-[10px] text-gray-600 italic">None</div>';
            
            const memoryTime = Math.max(3000, 6000 - (level * 150));
            document.getElementById('timer-text').innerText = `Vanish in ${(memoryTime/1000).toFixed(1)}s`;

            memoryOverlay.style.display = 'flex';
            const bar = document.getElementById('memory-timer-bar');
            bar.style.transition = 'none';
            bar.style.width = '100%';
            
            setTimeout(() => {
                bar.style.transition = `width ${memoryTime}ms linear`;
                bar.style.width = '0%';
            }, 50);

            setTimeout(() => {
                memoryOverlay.style.display = 'none';
                gameActive = true;
                palette.style.opacity = '1';
                palette.style.pointerEvents = 'auto';
                phaseLabel.innerText = `Cook ${ingredientsToCookThisRound} items!`;
                startLevelTimer();
            }, memoryTime + 50);
        }

        function startLevelTimer() {
            timeLeft = Math.max(8, 15 - (level * 0.3)); 
            timerEl.innerText = Math.floor(timeLeft);
            
            levelTimerInterval = setInterval(() => {
                if (!gameActive) return;
                timeLeft--;
                timerEl.innerText = timeLeft < 10 ? `0${Math.floor(timeLeft)}` : Math.floor(timeLeft);
                
                if (timeLeft <= 5) {
                    timerEl.classList.add('animate-pulse', 'text-red-600');
                } else {
                    timerEl.classList.remove('animate-pulse', 'text-red-600');
                }

                if (timeLeft <= 0) {
                    clearInterval(levelTimerInterval);
                    loseLife('Time is up!');
                    if (lives > 0) startRound();
                }
            }, 1000);
        }

        let currentDragType = null;
        document.querySelectorAll('.ingredient-source').forEach(source => {
            const startDrag = (e) => {
                if (!gameActive) return;
                currentDragType = source.getAttribute('data-type');
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                dragProxy.innerText = TYPES[currentDragType].emoji;
                dragProxy.style.display = 'block';
                dragProxy.style.left = `${clientX - 20}px`;
                dragProxy.style.top = `${clientY - 20}px`;
            };
            source.addEventListener('mousedown', startDrag);
            source.addEventListener('touchstart', startDrag);
        });

        const handleMove = (e) => {
            if (!currentDragType) return;
            const x = e.touches ? e.touches[0].clientX : e.clientX;
            const y = e.touches ? e.touches[0].clientY : e.clientY;
            dragProxy.style.left = `${x - 20}px`;
            dragProxy.style.top = `${y - 20}px`;
        };
        window.addEventListener('mousemove', handleMove);
        window.addEventListener('touchmove', handleMove);

        const endDrag = (e) => {
            if (!currentDragType) return;
            const clientX = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
            const clientY = e.changedTouches ? e.changedTouches[0].clientY : e.clientY;
            const potRect = potArea.getBoundingClientRect();
            const x = clientX - potRect.left;
            const y = clientY - potRect.top;
            
            const dx = x - 160;
            const dy = y - 160;
            const dist = Math.sqrt(dx*dx + dy*dy);
            
            if (dist < 150) {
                let side = '';
                if (level < 5) {
                    side = (x < 160) ? 'spicy' : 'clear';
                } else {
                    // Normalize angle to 0-360 starting from Top/North
                    const angle = Math.atan2(dy, dx) * (180 / Math.PI); 
                    let adj = (angle + 90 + 360) % 360; 

                    if (adj >= 0 && adj < 120) {
                        side = 'clear'; 
                    } else if (adj >= 120 && adj < 240) {
                        side = 'tomato'; 
                    } else {
                        side = 'spicy'; 
                    }
                }
                dropIngredient(currentDragType, x, y, side);
            }
            currentDragType = null;
            dragProxy.style.display = 'none';
        };
        window.addEventListener('mouseup', endDrag);
        window.addEventListener('touchend', endDrag);

        function dropIngredient(typeKey, x, y, side) {
            const listToSearch = currentRecipe[side];
            const recipeIdx = listToSearch.indexOf(typeKey);
            
            if (recipeIdx === -1) {
                loseLife(`Wrong side! That's ${side}!`);
                return;
            }

            const type = TYPES[typeKey];
            const id = 'ing_' + Math.random().toString(36).substr(2, 9);
            const el = document.createElement('div');
            el.className = 'ingredient';
            el.style.left = (x - 25) + 'px';
            el.style.top = (y - 25) + 'px';
            
            let effect = '';
            if (side === 'spicy') effect = 'filter: sepia(0.5) saturate(3) hue-rotate(-20deg);';
            if (side === 'tomato') effect = 'filter: saturate(2) hue-rotate(-10deg);';
            
            el.innerHTML = `<div class="ingredient-icon" style="${effect}">${type.emoji}</div><div class="cooking-timer">RAW</div>`;
            
            const action = (e) => { e.stopPropagation(); eatIngredient(id); };
            el.addEventListener('click', action);
            el.addEventListener('touchstart', action);

            potArea.appendChild(el);

            activeIngredients.push({ 
                id, type: typeKey, el, 
                startTime: Date.now(), 
                targetTime: type.time, 
                status: 'raw', side
            });
        }

        function updateGame() {
            if (gameActive && ingredientsToCookThisRound === 0 && activeIngredients.length === 0 && lives > 0) {
                gameActive = false;
                clearInterval(levelTimerInterval);
                level++;
                showFeedback(`Level ${level}!`, 'text-yellow-400');
                setTimeout(startRound, 1500);
            }

            const now = Date.now();
            activeIngredients.forEach((ing) => {
                const elapsed = now - ing.startTime;
                const timerEl = ing.el.querySelector('.cooking-timer');
                const iconEl = ing.el.querySelector('.ingredient-icon');
                
                if (elapsed < ing.targetTime * 0.7) {
                    ing.status = 'raw';
                    timerEl.innerText = 'RAW';
                    timerEl.className = 'cooking-timer text-yellow-500';
                } else if (elapsed < ing.targetTime * 1.3) {
                    ing.status = 'perfect';
                    timerEl.innerText = 'EAT!';
                    timerEl.className = 'cooking-timer text-green-400 font-bold';
                    iconEl.style.transform = `scale(${1 + Math.sin(now/100)*0.1})`;
                } else if (elapsed < ing.targetTime * 2.0) {
                    ing.status = 'overcooked';
                    timerEl.innerText = 'OVER';
                    timerEl.className = 'cooking-timer text-gray-500';
                    iconEl.style.transform = `scale(1)`;
                } else {
                    loseLife('Overcooked!');
                    removeIngredient(ing.id);
                }
            });
            requestAnimationFrame(updateGame);
        }

        function eatIngredient(id) {
            const index = activeIngredients.findIndex(i => i.id === id);
            if (index === -1) return;
            const ing = activeIngredients[index];
            
            if (ing.status === 'perfect') {
                score += TYPES[ing.type].points * level;
                showFeedback('Delicious!', 'text-green-400');
                
                const list = currentRecipe[ing.side];
                const listIdx = list.indexOf(ing.type);
                if (listIdx > -1) list.splice(listIdx, 1);

                ingredientsToCookThisRound--;
                phaseLabel.innerText = `Goal: Cook ${ingredientsToCookThisRound} more!`;
            } else {
                loseLife(ing.status === 'raw' ? 'Too raw!' : 'Overcooked!');
            }
            removeIngredient(id);
        }

        function removeIngredient(id) {
            const index = activeIngredients.findIndex(i => i.id === id);
            if (index !== -1) {
                const el = activeIngredients[index].el;
                if(el && el.parentNode) el.parentNode.removeChild(el);
                activeIngredients.splice(index, 1);
            }
        }

        function loseLife(msg) {
            lives--;
            livesEl.innerText = '‚ù§Ô∏è'.repeat(lives) + 'üñ§'.repeat(Math.max(0, 3 - lives));
            showFeedback(msg, 'text-red-500');
            if (lives <= 0) gameOver(msg);
        }

        function showFeedback(text, colorClass) {
            feedbackEl.innerText = text;
            feedbackEl.className = `fixed left-1/2 -translate-x-1/2 top-1/2 text-2xl font-bold pointer-events-none transition-all duration-700 opacity-100 ${colorClass} z-50`;
            setTimeout(() => { feedbackEl.style.opacity = '0'; feedbackEl.style.transform = 'translate(-50%, -50px)'; }, 10);
            setTimeout(() => { feedbackEl.style.transform = 'translate(-50%, 0)'; }, 710);
        }

        function gameOver(msg) {
            gameActive = false;
            clearInterval(levelTimerInterval);
            gameOverOverlay.style.display = 'flex';
            document.getElementById('over-msg').innerText = msg;
            document.getElementById('final-score').innerText = score;
            document.getElementById('final-level').innerText = level;
        }

        setInterval(() => {
            if (!gameActive && memoryOverlay.style.display === 'none') return;
            const steam = document.createElement('div');
            steam.className = 'steam';
            steam.style.left = (Math.random() * 80 + 10) + '%';
            steam.style.top = (Math.random() * 60 + 20) + '%';
            potArea.appendChild(steam);
            setTimeout(() => steam.remove(), 2500);
        }, 600);

        startRound();
        requestAnimationFrame(updateGame);
    </script>
</body>
</html>

